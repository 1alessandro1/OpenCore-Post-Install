<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fixing Sleep | OpenCore Post-Install</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="&#39;stylesheet" href="/OpenCore-Post-Install/styles/website.css">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/OpenCore-Post-Install/assets/css/0.styles.54998e6c.css" as="style"><link rel="preload" href="/OpenCore-Post-Install/assets/js/app.49ac4054.js" as="script"><link rel="preload" href="/OpenCore-Post-Install/assets/js/2.1f2b73b4.js" as="script"><link rel="preload" href="/OpenCore-Post-Install/assets/js/10.c2b2f449.js" as="script"><link rel="preload" href="/OpenCore-Post-Install/assets/js/28.a0dc0ef4.js" as="script"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/11.75e4a439.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/12.372f3fd4.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/13.6fd2ccb2.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/14.4a2bb6f0.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/15.b9777c9a.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/16.053812ac.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/17.4b483982.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/18.79947336.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/19.4f935b47.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/20.2e342c64.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/21.9a92af8f.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/22.1e859f71.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/23.b029f242.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/24.f2e7e8ce.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/25.8d44a9fe.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/26.e25bde63.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/27.aa247907.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/29.559efe04.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/3.82daa3c3.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/30.0154dc30.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/31.0a92cde2.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/32.5bfca490.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/33.0a4e25b4.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/34.779adef6.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/35.e767b955.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/36.cb6e1fc5.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/37.28dbbdf3.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/4.d0888c6d.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/5.a8b6d8de.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/6.e30afd94.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/7.f680a8d2.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/8.fdaba85d.js"><link rel="prefetch" href="/OpenCore-Post-Install/assets/js/9.6e89554e.js">
    <link rel="stylesheet" href="/OpenCore-Post-Install/assets/css/0.styles.54998e6c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/OpenCore-Post-Install/" class="home-link router-link-active"><img src="/OpenCore-Post-Install/homepage.png" alt="OpenCore Post-Install" class="logo"> <span class="site-name can-hide">OpenCore Post-Install</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Dortania Guides" class="dropdown-title"><span class="title">Dortania Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dortania.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home Site
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/OpenCore-Desktop-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OpenCore Install Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Getting-Started-With-ACPI/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Getting Started With ACPI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/GPU-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GPU Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Wireless-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Wireless Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Anti-Hackintosh-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Anti Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <a href="https://github.com/dortania/OpenCore-Post-Install" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Dortania Guides" class="dropdown-title"><span class="title">Dortania Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dortania.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home Site
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/OpenCore-Desktop-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OpenCore Install Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Getting-Started-With-ACPI/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Getting Started With ACPI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/GPU-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GPU Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Wireless-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Wireless Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dortania.github.io/Anti-Hackintosh-Buyers-Guide/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Anti Buyers Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <a href="https://github.com/dortania/OpenCore-Post-Install" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Introduction</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/" aria-current="page" class="sidebar-link">OpenCore Post-Install</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Universal</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/universal/security.html" class="sidebar-link">Security and FileVault</a></li><li><a href="/OpenCore-Post-Install/universal/audio.html" class="sidebar-link">Fixing Audio</a></li><li><a href="/OpenCore-Post-Install/universal/oc2hdd.html" class="sidebar-link">Booting without USB</a></li><li><a href="/OpenCore-Post-Install/universal/update.html" class="sidebar-link">Updating OpenCore, kexts and macOS</a></li><li><a href="/OpenCore-Post-Install/universal/drm.html" class="sidebar-link">Fixing DRM</a></li><li><a href="/OpenCore-Post-Install/universal/iservices.html" class="sidebar-link">Fixing iServices</a></li><li><a href="/OpenCore-Post-Install/universal/pm.html" class="sidebar-link">Fixing Power Management</a></li><li><a href="/OpenCore-Post-Install/universal/sleep.html" aria-current="page" class="active sidebar-link">Fixing Sleep</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/universal/sleep.html#preparations" class="sidebar-link">Preparations</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/universal/sleep.html#main-culprits" class="sidebar-link">Main culprits</a></li><li class="sidebar-sub-header"><a href="/OpenCore-Post-Install/universal/sleep.html#other-culprits" class="sidebar-link">Other Culprits</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>USB Fixes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/usb/" class="sidebar-link">USB Mapping: Introduction</a></li><li><a href="/OpenCore-Post-Install/usb/system-preparation.html" class="sidebar-link">System Preparation</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>USB Mapping</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Miscellaneous Fixes</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Laptop Specifics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/laptop-specific/battery.html" class="sidebar-link">Fixing Battery Read-outs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Cosmetics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/cosmetic/verbose.html" class="sidebar-link">Fixing Resolution and Verbose</a></li><li><a href="/OpenCore-Post-Install/cosmetic/gui.html" class="sidebar-link">Add GUI and Boot-chime</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Multiboot</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/multiboot/bootstrap.html" class="sidebar-link">Setting up Bootstrap.efi</a></li><li><a href="/OpenCore-Post-Install/multiboot/bootcamp.html" class="sidebar-link">Installing BootCamp</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/OpenCore-Post-Install/misc/rtc.html" class="sidebar-link">Fixing RTC</a></li><li><a href="/OpenCore-Post-Install/misc/msr-lock.html" class="sidebar-link">Fixing CFG Lock</a></li><li><a href="/OpenCore-Post-Install/misc/nvram.html" class="sidebar-link">Emulated NVRAM</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-succinct-content content__default"><h1 id="fixing-sleep"><a href="#fixing-sleep" class="header-anchor">#</a> Fixing Sleep</h1> <ul><li>Supported version: 0.5.9</li></ul> <p>So to understand how to fix sleep issues in macOS, we need to first look at what contributes to sleep issues most of the time:</p> <ul><li>Incorrectly managed devices(most commonly PCIe based devices)</li></ul> <p>The reason for this is when devices get an S3 call(or S0 for wake), the driver needs to power down the devices and put into a low state mode(vice versa when waking). Problems arise when such devices don't cooperate with the drivers and the main offenders of these issues are:</p> <ul><li>USB Controllers and Devices</li> <li>GPUs</li> <li>Thunderbolt Controllers and Devices</li> <li>NICs(Both Ethernet and Wifi)</li> <li>NVMe Drives</li></ul> <p>And there are others that can cause sleep issues that aren't directly(or obviously) related to PCI/e:</p> <ul><li>CPU Power Management</li> <li>Displays</li> <li>NVRAM</li> <li>RTC/System Clocks</li> <li>IRQ Conflicts</li> <li>Audio</li> <li>SMBus</li> <li>TSC</li></ul> <p>And something many people forget are over and under-clocks:</p> <ul><li>CPUs
<ul><li>AVX often breaks iGPUs and hurt overall stability</li></ul></li> <li>Bad RAM(Both overclocks and mismatched RAM)
<ul><li>Even bad/mismatched timings can cause serious issues</li></ul></li> <li>Factory GPU Overclocks
<ul><li>OEMs commonly push a card a bit too far with their custom VBIOS</li> <li>Generally these cards will have a physical switch, allowing you to choose a low power VBIOS</li></ul></li></ul> <h2 id="preparations"><a href="#preparations" class="header-anchor">#</a> Preparations</h2> <p><strong>In macOS</strong>:</p> <p>Before we get in too deep, we'll want to first ready our system:</p> <div class="language- extra-class"><pre class="language-text"><code>sudo pmset autopoweroff 0 
sudo pmset powernap 0 
sudo pmset standby 0
sudo pmset proximitywake 0
</code></pre></div><p>This will do 4 things for us:</p> <ol><li>Disables autopoweroff: This is a form of hibernation</li> <li>Disables powernap: Used to periodically wake the machine for network, and updates(but not the display)</li> <li>Disables standby: Used as a time period between sleep and going into hibernation</li> <li>Disables wake from iPhone/Watch: Specifically when your iPhone or Apple Watch come near, the machine will wake</li></ol> <p><strong>In your config.plist</strong>:</p> <p>While minimal changes are needed, here are the ones we care about:</p> <ul><li><code>Misc -&gt; Boot -&gt; HibernateMode -&gt; None</code> <ul><li>We're gonna avoid the black magic that is S4 for this guide</li></ul></li> <li><code>NVRAM -&gt; Add -&gt; 7C436110-AB2A-4BBB-A880-FE41995C9F82 -&gt; boot-args</code> <ul><li><code>keepsyms=1</code>- Makes sure that if a kernel panic does happen during sleep, that we get all the important bits from it</li></ul></li></ul> <p><strong>In your BIOS</strong>:</p> <ul><li>Disable:
<ul><li>Wake on LAN</li> <li>Trusted Platform Module
<ul><li>Note that if you're using BitLocker in Windows, disabling this will result in all your encryption keys being lost. If you're using BitLocker, either disable or note that it may be a cause for wake issues.</li></ul></li> <li>Wake on USB(Certain boards may actually require this on to wake, but most will get random wakeup calls with it)</li></ul></li> <li>Enable:
<ul><li>Wake on Bluetooth(If using a Bluetooth device for waking like a keyboard, otherwise you can disable)</li></ul></li></ul> <h2 id="main-culprits"><a href="#main-culprits" class="header-anchor">#</a> Main culprits</h2> <ul><li><a href="#fixing-usb">USB</a></li> <li><a href="#fixing-gpus">GPUs</a></li> <li><a href="#fixing-thunderbolt">Thunderbolt</a></li> <li><a href="#fixing-nics">NICs</a></li> <li><a href="#fixing-nvme">NVMe</a></li> <li><a href="#fixing-cpu-power-management">CPU Power Management</a></li></ul> <h3 id="fixing-usb"><a href="#fixing-usb" class="header-anchor">#</a> Fixing USB</h3> <p>This is the #1 cause of sleep issues on hacks, mainly because Apple's drivers are quite bad at guessing ports and the port limit patches have the ill-effect of creating instability.</p> <ul><li><a href="/OpenCore-Post-Install/usb/">USB Mapping</a></li></ul> <p>This guide also includes some other fixes than just mapping:</p> <ul><li><a href="/OpenCore-Post-Install/usb/misc/power.html">Fixing USB Power</a></li> <li><a href="/OpenCore-Post-Install/usb/misc/shutdown.html">Fixing Shutdown/Restart</a></li> <li><a href="/OpenCore-Post-Install/usb/misc/instant-wake.html">GPRW/UPRW/LANC Instant Wake Patch</a></li> <li><a href="/OpenCore-Post-Install/usb/misc/keyboard.html">Keyboard Wake Issues</a></li></ul> <p><strong>USB maps with macOS Catalina(10.15) and newer</strong>: You may find that even with USB mapping, your sleep breaks. one possible solution is renaming the IOClass value from <code>AppleUSBMergeNub</code> to <code>AppleUSBHostMergeProperties</code>. See here for more info: <a href="https://github.com/dortania/bugtracker/issues/15" target="_blank" rel="noopener noreferrer">Changes in Catalina's USB IOClass<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="fixing-gpus"><a href="#fixing-gpus" class="header-anchor">#</a> Fixing GPUs</h3> <p>With GPUs, it's fairly easy to know what might be causing issues. This being unsupported GPUs in macOS. By default, any GPU that doesn't have drivers already provided in the OS will run off very basic drivers known as VESA drivers. These provide minimal display output but also cause a big issue in that macOS doesn't actually know how to properly interact with these devices. To fix this, well need to either trick macOS into thinking it's a generic PCIe device(which it can better handle, ideal for desktops) or completely power off the card(on laptops, desktop dGPUs have issues powering down)</p> <ul><li>See here for more info:
<ul><li><a href="https://dortania.github.io/Getting-Started-With-ACPI/Desktops/desktop-disable" target="_blank" rel="noopener noreferrer">Disabling desktop dGPUs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://dortania.github.io/Getting-Started-With-ACPI/Laptops/laptop-disable" target="_blank" rel="noopener noreferrer">Disabling laptop dGPUs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <p>Special notes for iGPU users on 10.15.4 and newer:</p> <ul><li>iGPU wake is partially broken due to numerous hacks apple uses in AppleGraphicsPowerManagement.kext with real Macs, to get around this you'll likely need <code>igfxonln=1</code> to force all displays online. Obviously test first to make sure you have this issue.</li> <li>AAPL,ig-platform-id <code>07009B3E</code> may fail for desktop Coffee Lake (UHD 630) users, you can try <code>00009B3E</code> instead</li></ul> <p>Special note for 4k Displays with AMD dGPUs:</p> <ul><li>Some displays may fail to wake randomly, mainly caused by AGDC preferences. To fix, apply this to your dGPU in DeviceProperties:
<ul><li><code>CFG,CFG_USE_AGDC | Data | 00</code></li> <li>You can find the PciRoot of your GPU with <a href="https://github.com/acidanthera/gfxutil/releases" target="_blank" rel="noopener noreferrer">gfxutil<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li><code>/path/to/gfxutil -f GFX0</code></li></ul></li></ul></li></ul> <p><img src="/OpenCore-Post-Install/assets/img/agdc.d3314b17.png" alt=""></p> <h3 id="fixing-thunderbolt"><a href="#fixing-thunderbolt" class="header-anchor">#</a> Fixing Thunderbolt</h3> <p>Thunderbolt is a very tricky topic in the community, mainly due to the complexity of the situation. You really have just 2 paths to go down if you want Thunderbolt and sleep to work simultaneously:</p> <ul><li>Disable Thunderbolt 3 in the BIOS</li> <li>Attempt to patch Thunderbolt 3:
<ul><li><a href="https://osy.gitbook.io/hac-mini-guide/details/thunderbolt-3-fix/" target="_blank" rel="noopener noreferrer">Thunderbolt 3 Fix<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/osy86/ThunderboltReset" target="_blank" rel="noopener noreferrer">ThunderboltReset<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/al3xtjames/ThunderboltPkg/blob/master/Docs/FAQ.md" target="_blank" rel="noopener noreferrer">ThunderboltPkg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <p>Note: Thunderbolt can be enabled without extra work <em>if</em> you're ok without sleep, and vice versa.</p> <h3 id="fixing-nics"><a href="#fixing-nics" class="header-anchor">#</a> Fixing NICs</h3> <p>NICs(network Interface Controllers) are fairly easy to fix with sleep, it's mainly the following:</p> <ul><li>Disable <code>WakeOnLAN</code> in the BIOS
<ul><li>Most systems will enter a sleep/wake loop with this enabled</li></ul></li> <li>Disable <code>Wake for network access</code> in macOS(SystemPreferences -&gt; Power)
<ul><li>Seems to break on a lot of hacks</li></ul></li></ul> <h3 id="fixing-nvme"><a href="#fixing-nvme" class="header-anchor">#</a> Fixing NVMe</h3> <p>So macOS can be quite picky when it comes to NVMe drives, and there's also the issue that Apple's power management drivers are limited to Apple branded drives only. So the main things to do are:</p> <ul><li>Make sure the NVMe is on the latest firmware(especially important for <a href="https://www.tonymacx86.com/threads/do-the-samsung-970-evo-plus-drives-work-new-firmware-available-2b2qexm7.270757/page-14#post-1960453" target="_blank" rel="noopener noreferrer">970 Evo Plus drives<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li> <li>Use <a href="https://github.com/acidanthera/NVMeFix/releases" target="_blank" rel="noopener noreferrer">NVMeFix.kext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to allow for proper NVMe power management</li></ul> <p>And avoid problematic drives, the main culprits:</p> <ul><li>Samsung's PM981 and PM991 SSDs</li> <li>Micron's 2200S</li></ul> <p>If you however do have these drives in your system, it's best to disable them via an SSDT: <a href="https://dortania.github.io/Getting-Started-With-ACPI/Desktops/desktop-disable.md" target="_blank" rel="noopener noreferrer">Disabling desktop dGPUs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
This guide is primarily for dGPU but works the exact same way with NVMe drives(as they're both just PCIe devices)</p> <h3 id="fixing-cpu-power-management"><a href="#fixing-cpu-power-management" class="header-anchor">#</a> Fixing CPU Power Management</h3> <p><strong>For Intel</strong>:</p> <p>To verify you have working CPU Power Management, see the <a href="/OpenCore-Post-Install/universal/pm.html">Fixing Power Management</a> page. And if not, then patch accordingly.</p> <p>Also note that incorrect frequency vectors can result in wake issues, so either verify you're using the correct SMBIOS or adjust the frequency vectors of your current SMBIOS with CPUFrend. Tools like <a href="https://github.com/stevezhengshiqi/one-key-cpufriend" target="_blank" rel="noopener noreferrer">one-key-cpufriend<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> are known for creating bad frequency vectors so be careful with tools not used by Dortania.</p> <p>A common kernel panic from wake would be:</p> <div class="language- extra-class"><pre class="language-text"><code>Sleep Wake failure in EFI
</code></pre></div><p><strong>For AMD</strong>:</p> <p>Fret not, for their is still hope for you as well! <a href="https://github.com/trulyspinach/SMCAMDProcessor" target="_blank" rel="noopener noreferrer">AMDRyzenCPUPowerManagement.kext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> can add power management to Ryzen based CPUs. Installation and usage is explained on the repo's README.md</p> <h2 id="other-culprits"><a href="#other-culprits" class="header-anchor">#</a> Other Culprits</h2> <ul><li><a href="#displays">Displays</a></li> <li><a href="#nvram">NVRAM</a></li> <li><a href="#rtc">RTC</a></li> <li><a href="#irq-conflicts">IRQ Conflicts</a></li> <li><a href="#audio">Audio</a></li> <li><a href="#smbus">SMBus</a></li></ul> <h3 id="displays"><a href="#displays" class="header-anchor">#</a> Displays</h3> <p>So display issues are mainly for laptop lid detection, specifically:</p> <ul><li>Incorrectly made SSDT-PNLF</li> <li>OS vs firmware lid wake</li> <li>Keyboard spams from lid waking it(On PS2 based keyboards)</li></ul> <p>The former is quite easy to fix, see here: <a href="https://dortania.github.io/Getting-Started-With-ACPI/" target="_blank" rel="noopener noreferrer">Backlight PNLF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>For the middle, macOS's lid wake detection can bit a bit broken and you may need to outright disable it:</p> <div class="language- extra-class"><pre class="language-text"><code>sudo pmset lidwake 0
</code></pre></div><p>And set <code>lidewake 1</code> to re-enable it.</p> <p>The latter requires a bit more work. What we'll be doing is trying to nullify semi random key spams that happen on Skylake and newer based HPs though pop up in other OEMs as well. This will also assume that your keyboard is PS2 based and are running <a href="https://github.com/acidanthera/VoodooPS2/releases" target="_blank" rel="noopener noreferrer">VoodooPS2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>To fix this, grab <a href="https://github.com/acidanthera/VoodooPS2/blob/master/Docs/ACPI/SSDT-HP-FixLidSleep.dsl" target="_blank" rel="noopener noreferrer">SSDT-HP-FixLidSleep.dsl<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and adapt the ACPI pathing to your keyboard(<code>_CID</code> value being <code>PNP0303</code>). Once this is done, compile and drop into both EFI/OC/ACPI and under config.plist -&gt; ACPI -&gt; Add.</p> <p>For 99% of HP users, this will fix the random key spam. If not, see below threads:</p> <ul><li><a href="https://www.tonymacx86.com/threads/guide-patching-dsdt-ssdt-for-laptop-backlight-control.152659/" target="_blank" rel="noopener noreferrer">RehabMan's brightness key guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="nvram"><a href="#nvram" class="header-anchor">#</a> NVRAM</h3> <p>To verify you have working NVRAM, see the <a href="/OpenCore-Post-Install/misc/nvram.html">Emulated NVRAM</a> page to verify you have working NVRAM. And if not, then patch accordingly.</p> <h3 id="rtc"><a href="#rtc" class="header-anchor">#</a> RTC</h3> <p>This is mainly relevant for Intel 300 series motherboards(Z3xx), specifically that there's 2 issues:</p> <ul><li>Be default the RTC is disabled(instead using AWAC)</li> <li>The RTC is usually not compatible with macOS</li></ul> <p>To get around the first issue, see here: <a href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/awac.html" target="_blank" rel="noopener noreferrer">Fixing AWAC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>For the second one, it's quite easy to tell you have RTC issues when you either shutdown or restart. Specifically you'll be greeted with a &quot;BIOS Restarted in Safemode&quot; error. To fix this, we'll need to prevent macOS from writing to the RTC regions causing these issues. There are a couple fixes:</p> <ul><li>DisableRtcChecksum: Prevent writing to primary checksum (0x58-0x59), works with most boards</li> <li><code>UEFI -&gt; ProtoclOverride -&gt; AppleRtcRam</code> + <code>NVRAM -&gt; Add -&gt; rtc-blacklist</code> <ul><li>Blacklists certain regions at the firmware level, see <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf" target="_blank" rel="noopener noreferrer">Configuration.pdf<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more info on how to set this up</li></ul></li> <li><a href="https://github.com/acidanthera/RTCMemoryFixup" target="_blank" rel="noopener noreferrer">RTCMemoryFixup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <code>rtcfx_exclude=</code> <ul><li>Blacklists certain regions at the kernel level, see README for more info on how to setup</li></ul></li></ul> <p>With some legacy boards, you may actually need to patch your RTC: <a href="https://www.insanelymac.com/forum/topic/329624-need-cmos-reset-after-sleep-only-after-login/" target="_blank" rel="noopener noreferrer">Z68 RTC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="irq-conflicts"><a href="#irq-conflicts" class="header-anchor">#</a> IRQ Conflicts</h3> <p>IRQ issues usually occur during bootups but some may notice that IRQ calls can break with sleep, this fix is fairly easy:</p> <ul><li><a href="https://github.com/corpnewt/SSDTTime" target="_blank" rel="noopener noreferrer">SSDTTime<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>First dump your DSDT in Linux/Windows</li> <li>then select <code>FixHPET</code> option</li></ul></li></ul> <p>This will provide you with both SSDT-HPET.aml and <code>oc_patches.plist</code>, You will want to add the SSDT to EFI/OC/ACPI and add the ACPI patches into your config.plist from the oc_patches.plist</p> <h3 id="audio"><a href="#audio" class="header-anchor">#</a> Audio</h3> <p>Unmanaged or incorrectly managed audio devices can also cause issues, either disable unused audio devices  in your BIOS or verify they're working correctly here:</p> <ul><li><a href="/OpenCore-Post-Install/universal/audio.html">Fixing Audio</a></li></ul> <h3 id="smbus"><a href="#smbus" class="header-anchor">#</a> SMBus</h3> <p>Main reason you'd care about SMBus is AppleSMBus can help properly manage both SMBus and PCI devices like with power states. Problem is the kext usually won't load by itself, so you'll need to actually create the SSDT-SMBS-MCHC.</p> <p>See here on more info on how to make it: <a href="https://dortania.github.io/Getting-Started-With-ACPI/Universal/smbus.html" target="_blank" rel="noopener noreferrer">Fixing SMBus support<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="tsc"><a href="#tsc" class="header-anchor">#</a> TSC</h3> <p>The TSC(Time Stamp Counter) is responsible for making sure you're hardware is running at the correct speed, problem is some firmware(mainly HEDT/Server and Asus Laptops) will not write the TSC to all cores cause issues. To get around this, we have 3 options:</p> <ul><li><a href="https://github.com/lvs1974/CpuTscSync/releases" target="_blank" rel="noopener noreferrer">CpuTscSync<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>For troublesome laptops</li></ul></li> <li><a href="https://bitbucket.org/RehabMan/VoodooTSCSync/downloads/" target="_blank" rel="noopener noreferrer">VoodooTSCSync<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>For most HEDT hardware</li></ul></li> <li><a href="https://github.com/interferenc/TSCAdjustReset" target="_blank" rel="noopener noreferrer">TSCAdjustReset<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>For Skylake X/W/SP and Cascade Lake X/W/SP hardware</li></ul></li></ul> <p>The former 2 are plug n play, while the latter will need some customizations:</p> <ul><li>Open up the kext(ShowPackageContents in finder, <code>Contents -&gt; Info.plist</code>) and change the Info.plist -&gt; <code>IOKitPersonalities -&gt; IOPropertyMatch -&gt; IOCPUNumber</code> to the number of CPU threads you have starting from <code>0</code>(i9 7980xe 18 core would be <code>35</code> as it has 36 threads total)</li> <li>Compiled version can be found here: <a href="https://github.com/dortania/OpenCore-Desktop-Guide/blob/master/extra-files/TSCAdjustReset.kext.zip" target="_blank" rel="noopener noreferrer">TSCAdjustReset.kext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p><img src="/OpenCore-Post-Install/assets/img/tsc.89adc3ad.png" alt=""></p> <p>The most common way to see the TSC issue:</p> <table><thead><tr><th style="text-align:center;">Case 1</th> <th style="text-align:center;">Case 2</th></tr></thead> <tbody><tr><td style="text-align:center;"><img src="/OpenCore-Post-Install/assets/img/asus-tsc.2397797f.png" alt=""></td> <td style="text-align:center;"><img src="/OpenCore-Post-Install/assets/img/asus-tsc-2.029ce318.png" alt=""></td></tr></tbody></table></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/16/2020, 1:56:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ⟵
      <a href="/OpenCore-Post-Install/universal/pm.html" class="prev">
        Fixing Power Management
      </a></span> <span class="next"><a href="/OpenCore-Post-Install/usb/">
        USB Mapping: Introduction
      </a>
      ⟶
    </span></p></div> </main></div><div class="global-ui"><div style="visibility:hidden;display:none;"></div><!----></div></div>
    <script src="/OpenCore-Post-Install/assets/js/app.49ac4054.js" defer></script><script src="/OpenCore-Post-Install/assets/js/2.1f2b73b4.js" defer></script><script src="/OpenCore-Post-Install/assets/js/10.c2b2f449.js" defer></script><script src="/OpenCore-Post-Install/assets/js/28.a0dc0ef4.js" defer></script>
  </body>
</html>
